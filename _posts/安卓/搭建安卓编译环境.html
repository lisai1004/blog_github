<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>搭建安卓编译环境</title>
	<meta name='Generator' content='Zim 0.67'>
	<style type='text/css'>
		a          { text-decoration: none      }
		a:hover    { text-decoration: underline }
		a:active   { text-decoration: underline }
		strike     { color: grey                }
		u          { text-decoration: none;
					 background-color: yellow   }
		tt         { color: #2e3436;            }
		pre        { color: #2e3436;
					 margin-left: 20px          }
		h1         { text-decoration: underline;
					 color: #4e9a06; margin-bottom: 0 }
		h2         { color: #4e9a06; margin-bottom: 0 }
		h3         { color: #4e9a06; margin-bottom: 0 }
		h4         { color: #4e9a06; margin-bottom: 0 }
		h5         { color: #4e9a06; margin-bottom: 0 }
		p          { margin-top: 0              }
		span.zim-tag {
			color: #ce5c00;
		}
		div.zim-object {
			border-style:solid;
			border-width:1px;
		}
		.checked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8sMEGsKGkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEBUlEQVRIx62V22tdRRTGf7Nn73P2ybntnNOe3NqkPTGgLTVUUZF6QatSLOKTPgqCIqLgQ0H/A1sQQbBYCBb1QfAxiC8tSO1FqHkwJVKtjdTGNraUmObsc9nXmfGh7cGYpM1D5nHWzPetteZb3wg2eB2YqYm4zSadsMtoboiNBH/3TE0awx6j+MRoxoTg/IYRvP19TQrJS0bzhdHGSyKFkLTtjSKwMjyiEz43ynhtP6bdjBCWyFobAf7eT7VhNF/q1FRbjYjmUohlCVPwnB+6FUxMTJipqSmUUhhjEGKd3bMT4ks/Y6oLBK2Yth8hHYtCJXOix7Nf7xLMzc0xOzvLzp078TyPNE3viW3QJPXzhNWbxFFKHCmMhoLn/FHodd48vGfhapdAacXQlkFK5dL6wIUm6fuTZPuvqDQhaMUYYyiVyuQr6rXDexYuAdi3tSv1ZJNs/R/CaszzT+1na88uXFnCEnJVgivBNN8uTJKmHQI/ptOOcXNZzMz9mOqFs90OHpipWcYwlo5P4ebnuOkrvr5wgrH+h3im7y36MzuwRXYZeKha/OhP0EkadFoxQSdGSotedR/+XwMc2XvKdNUFOFqZx6LKZWIiwjgkikNmLp/hm8sH+K1zjFTHXfBYdTi+eJArzXM0GxFxoBDCopLvo/fqEwi1XPkWkGqjFo2TgB1jOYZUKZTS/D1/ncmLh7jon0IbRWoiTi59ymzzJEEQE3cStNZsGxqlfPE57MBbOR8fP3hDGalOO9fq2DlBvmZw8xa2IxACGn6TydlD/O6f5OzSV/zif0cYhLQaEXGkKBbz7Ov/AOlXV1cxgBJRI3fuSTrpTawt18kWIZN1CFuaONI0w0WOXfsI43YIggh/KUSlhqxrMz74AkOZcWBm9QkH+Gw8NDLuITi+m0yzhluSyJzBLcpblUhFxywSRAEtPwQjsKVN30CNh0uvYuOubSHLtN3J0TO1j0pmBNuFbFWRK0gyPRZpktL2I5JQkclKakNlnh54g6ocvevUr/Ai2a7wineEkcJupA3S1Wg0nVZM2E6wbEF5U5G9Q++wI7sfR7h3N8HVNstykBfzH+KJEZwiWD0aIwxCgJ0R1Mu7GXOeJSuK93bZtQIle4D9pUNU5DC5jEsu55AvZakM5NicGyEj8uuz8bUCQgj67QfY671P3vEoeC69gy695U1U7NG7XV0pUwBjDJa1/JJlWWxzHuflzQe5FJ/GsgUVuZ2t8lEkTvfc0aNHb72flBhjVicQQqCUuvM3/M+WDVguWBrMVdDXEGZlBVEUrVCU9d9s5+fnaTQa2PZyPxEIhJaI1EEoZwX4ncynp6fXrmB4eJjR0VFarRbNZnP9P9rt9gohqNVq1Ov1ZbF/AZGev3hLJ2/zAAAAAElFTkSuQmCC)}
		.xchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8bDYnDxEwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEK0lEQVRIx9WVS2hTWRjHf/eR3CY1nbxMH2YiZRQS6qO13YlMVxY3SnVcuNIBFezGpSADLoQqLu1sHJCqdCFSXFpw4YOCSH3BtFqttTNamabX3DS5bfO6uffMoglja3RGcDMHzuac7/z/53++//cd+L8P6VuCPQYZ8ADNgBd4J31DcDcQs+GnHByRocEDv0kfBSjAOlYCs11Q+gpwDegS8LMJ+3QIK0ATzEhV8Odnz5bzw8P4dJ25aJQ/WlvJ1df/K7hSLtOcTNI+Pk69rpMTgqIQhCDvh1/VSpw79+gRrRMTmLZNezLJJsPg+a5dmOEwQlFqg1sWG16/Jv7sGWXDwBACFQjC9HcwIMONKkGp4PGAJGEDS0IQmZlhnWnye3c3eiyGo6qr3WHbrJ+dJf7gAXI6zSIr72T7/fgzmT4FHnTBsgrQBfYvTU0km5vxz86iADnAm0rRPTWFt7cXZccOJJcLAGHb2K9ekT93jmwmwwdAAFpjI6Ntbfxw5879ag7l6o1sr5eHHR3IsRgeQK/M4sQE+YEB7JcvEY6zAj45SWFgAPPxYwzHoQxIkQjTPT0kIxE+Noj8sexFn4/xnh58iQTeSpHkHAdrbIzi0BCOrmNPTpK/eJHM3bt8sCyKQCiR4NWePWSiUZw1+ZLXJm4pFKLhzBlCsRh2RUXacVgeGaF47RrL58+zcP8+RrmMkCQinZ1EL1zAjERqmkH+tLYl1G3bCJw4QUjT0IA0MJfLMX/5MqmHD0nZNiUgtGULG/r7ccXjINWuWbnmqsuFu7sb/4EDNLlcBIEioNs2KUAFGmMxmk6dQm1tRZI+3xBqEkiShBQOox05Ql1nJ26gvuIUAWiKQnj/ftStW5Fk+YuF+NldsbBA4cYN9KdPmaso8Fc62ZJtk7l1C2t0FGdxESHE1xE4hkHh6lX0oSHSpRIewC/LrPf7CSgKNpCamkI/fZr8pUuIZBIcpyaBunahPp1mub+fDyMjGKUSChCsq6Nh717q9u2jbnSU0uAgRrFIwTThyhUCqRS+hgZKLS1fJvDm87SNjZGcnsYUAjcQ8vsJ9/Xh7u1FDgRQN20iks3iDA+zZFmYhQLqzZtsj8WY3L0baY2Sf55ICCKpFHUzM2SEQAJCHg+hY8fQDh5EDgRWDoRC1J88SePRo2geD0XAcBy8b98Sv3ePYDZbbf2rFQjLIphMsmDbaEBQVQkePox26BCSz7e6i4bDrDt+nGYhmBscpFAskheC4Js3bPR4qHphFYEnlcI7P4/jdqNpGu8TCe4oCsXr1z//F2ga3+/cSfTJE0qmSVYIsKzaOZDcbjKyzFIiwfvt21kMBLA07YsetzWNd+3tLLW0sH5igvT8PH9Go/z44kX+E4LGjg7GDYOcy4XlOEgLC//5P/5LCFzxOPLmzWyIx+m6fduu7v0NVGqyTSycKksAAAAASUVORK5CYII=)}
		.unchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8qAt8h3m8AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA60lEQVRIx+2VsQqDMBRF70sCLg5OLoKgjk7+lJ/hh+STXBwcnRz8ArMEkrxOFktbaC3tULzTg5e8k5vADXDq70VbobXmvu/hvQczg4heHrJfXxQFuq67blZbMc8zpmlCXddIkgTOuZcBUko45zCOI6y1Nz2xFSEEZFmGOI7fGg4A3nsQEZqmuXOu9jallACAtm3fvmutNaIoAjM/dkBECCF89KCbk4eAb+kEnIAT8EsAM0OIz3hSyrssUvss8t5fg+uIrLXPs0gIgWVZYIyBUurQyYdheO4gz3NUVQVjDNZ1PfSjpWmKsixvehfB9GBZ3NndrgAAAABJRU5ErkJggg==)}
		.migrated-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB+AKHREFA8vJSnkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAC1klEQVRIx+2VT0hUURTGf/e958w4Tc3TYowMw1GyEgwr1MqsFmbZIrIWQZsWJUjbdoHQpl3Qps0swnCRECQFYkR/TC1iKkqmfzAKTo2Vf8hoRsfR995tkRMT87RRWkUHHhy495zvnvvu933wP/75EKkkEAjIYDCIaZpIKRFCZN0kfX9xcTGtra2/irVUEolECIfDlJeXo+s6hmFkDaCqKoZhEAqFSCaTv60pqcSyLAoLC/F4PEtqDmCaJkIIKisrMybX0sdUVRWA5ubmPzdNjjI1cpXkZC/O1fV03PXgdDqRUtpPIITAsqxsDz0Z/3CZQv8uqo4N4C8/Tp2/DdM0MiZQlvk41OTkI/LW1SGtCVb5drD3eCc71wcA+VcAHA5vDd8+3UGakxiJV7i9pdQevU5T1R35pJ3MV5QW1pf+0kWBheJ2SWua8EQXZXsu4fVVYEz1sEKvof5EuxjoPvzpcRvrdp9C2gGMx6cpOHBmbImMesds7BZubwMVDTfXDnQ3vQfK7AC8wLfExMX5whyQc3q2OEnjGm5vE76SQxsfBLr77a7CNf+n0r/l6sSMtsBSnurckiIILCobAtVZhpF4gZF4jubaymj4Ch/fd380LE7bAnjc0NPxk2yqpmEuwGxF0ag+0k5uTpzZeBeaazvj0We8fXojainsb2xh2BZgbe0gSIllzSIUh63wfQ6dZ/O2fbjcKlOj58jJ3cVENESw5yErc9nf2MLQ4jwQAkV1Lqiq37/cZ9WaahJjF9AcmxiPDhLs7ePe23oOnmUwg2hSShQle96tKDjA2HAniusgo9FxnvY9Jxw7RWzGYy92QghM00x5g53qp9sHmtB58/o2umOI2NwGolMnMYUHIb7aAyiKwsjICLqu2/qBEIKUUAohMaSHSLyBSMoPTINQ6CX5+fn2AEVFRZSUlBCPx4nFYhl3L4RESjF/GEgX3pSj+Xw+/H7/b3U/AEOZFnp7O5+5AAAAAElFTkSuQmCC)}
		ul {list-style-image: none}
		/* ul rule needed to reset style for sub-bullets */
	</style>
</head>
<body>

<!-- Wiki content -->

	<p>
Content-Type: text/x-zim-wiki<br>
Wiki-Format: zim 0.4<br>
Creation-Date: 2017-08-03T14:29:00+08:00
</p>

<h1>搭建安卓编译环境</h1>

<p>
Created 星期四 03 八月 2017<br>
(1）安装编译工具<br>
<div style='padding-left: 30pt'>
sudo apt-get install -y git flex bison gperf build-essential libncurses5-dev:i386<br>
sudo apt-get install libx11-dev:i386 libreadline6-dev:i386 libgl1-mesa-dev g++-multilib<br>
sudo apt-get install tofrodos python-markdown libxml2-utils xsltproc zlib1g-dev:i386<br>
sudo apt-get install dpkg-dev libsdl1.2-dev libesd0-dev<br>
sudo apt-get install git-core gnupg flex bison gperf build-essential<br>
sudo apt-get install zip curl zlib1g-dev gcc-multilib g++-multilib<br>
sudo apt-get install libc6-dev-i386<br>
sudo apt-get install lib32ncurses5-dev x11proto-core-dev libx11-dev<br>
sudo apt-get install lib32z-dev ccache<br>
sudo apt-get install libgl1-mesa-dev libxml2-utils xsltproc unzip m4
</div>
注：安装过程中可能出现版本不匹配的问题，但是系统会给出应安装的正确版本提示，按照系统提示安装即可。如果出现不能安装的情况，可以执行 sudo apt-get update 后再进行安装，如果再安装不上，则可以放弃，影响不大。如果电脑里没有git一定要安装一下git。<br>
（2）安装jdk<br>
Android4.4的源码编译所使用的jdk为oracle jdk1.6。由于不能直接下载，所以可在论坛或网盘上找资源下载jdk1.6.0_45.下载后为.bin文件<br>
首先在/usr/loacl目录下创建jvm文件夹用来存放jdk<br>
<div style='padding-left: 30pt'>
mkdir /usr/local/jvm
</div>
然后进入到Downloads下找到刚才下载的jdk，复制到/usr/local/jvm中<br>
<div style='padding-left: 30pt'>
cp jdk-6u45-linux-x64.bin /usr/local/jvm
</div>
然后进入到/usr/local/jvm下，给.bin文件一个可执行权限<br>
<div style='padding-left: 30pt'>
chmod +x jdk-6u45-linux-x64.bin
</div>
执行.bin文件进行安装<br>
<div style='padding-left: 30pt'>
./jdk-6u45-linux-x64.bin
</div>
安装成功后设置环境变量，打开/etc/profile，添加如下几行后保存<br>
<div style='padding-left: 30pt'>
export JAVA_HOME=/usr/local/java/jdk1.6.0_45<br>
export JRE_HOME=/usr/local/java/jdk1.6.0_45/jre<br>
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH<br>
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$JAVA_HOME:$PATH
</div>
修改后Log Out之后再进入，在终端输入java -version，显示java version "1.6.0_45"则为配置成功<br>
注：编译的时候jdk一定要安装1.6的最高版本，即jdk1.6.0_45，否则编译中会报错，android:搭建安卓编译环境:推荐下载地址http:download.csdn.netdetailjavahr7291125<br>
（3）安装make<br>
由于ubuntu16.04自带make版本过高，无法编译。因此需要将make降至3.81或3.82版本(最好使用3.81)<br>
android:搭建安卓编译环境:下载地址ftp:ftp.gnu.orggnumake<br>
下载后到Downloads下将文件拷到其他目录（home下即可），然后解压<br>
<div style='padding-left: 30pt'>
tar -zxvf make3.8.2.tar.gz
</div>
解压后进入到make3.8.2的目录下<br>
<div style='padding-left: 30pt'>
./configure<br>
make<br>
make install
</div>
执行完后在/usr/local/bin中可得到新版本的make，复制到/usr/bin中即可<br>
注：make过程中可能会出现错误，不用理会，只要make install能够成功执行即可。<br>
（4）编译<br>
首先在.bashrc文件末尾追加export USE_CCACHE = 1<br>
<div style='padding-left: 30pt'>
echo export USE_CCACHE=1 &gt;&gt; ~/.bashrc
</div>
然后导入编译Android源码所需的环境变量和其他参数：<br>
<div style='padding-left: 30pt'>
source build/envsetup.sh
</div>
然后<br>
<div style='padding-left: 30pt'>
make clean<br>
make update-api<br>
make
</div>
注：其中前两行不是必须的，make update-api可能会出错，但是影响不大。<br>
最后一行make也可以用make -j4（四线程编译），电脑性能好的可以用make -j8或-j10，总之是二的倍数。我怕电脑死机只用了make，不过稍微有点慢。<br>
如果没什么意外的话等待编译成功就好了。。。<br>
（5）启动Android模拟器<br>
<div style='padding-left: 30pt'>
source build/envsetup.sh<br>
lunch sdk-eng<br>
emulator
</div>
等待一会之后模拟器即可启动<br>
（6）最后：<br>
过程整理出来大概就是这样，由于上文好多命令都是我自己手敲上去的，可能有的敲错了，给大家推荐两篇参考博客<br>
<a href="http://www.jianshu.com/p/6d97b4a10b18" title="http://www.jianshu.com/p/6d97b4a10b18" class="http">http://www.jianshu.com/p/6d97b4a10b18</a><br>
<a href="http://blog.sina.com.cn/s/blog_6e65e8cc0102wm83.html" title="http://blog.sina.com.cn/s/blog_6e65e8cc0102wm83.html" class="http">http://blog.sina.com.cn/s/blog_6e65e8cc0102wm83.html</a>
</p>

<br>

<p>
附:<br>
1.~/.bashrc<br>
 #demon add at 20170707  <br>
export JAVA_HOME=/usr/local/jvm/jdk1.6.0_45<br>
export JRE_HOME=/usr/local/jvm/jdk1.6.0_45/jre<br>
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH<br>
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$JAVA_HOME:$PATH<br>
export ANDROID_JAVA_HOME=$JAVA_HOME<br>
export PATH=~/bin:$PATH<br>
ARM_PATH=/opt/arm-2010q1/bin<br>
ARC_PATH=/opt/gnutools/arc2.3-p2/elf32-4.2.1/bin                            <br>
M8_PATH=/opt/arc-4.8-amlogic-20130904-r2/bin:/opt/gcc-linaro-arm-linux-gnuea    bihf/bin<br>
export PATH=${CLASSPATH}:${ARM_PATH}:${ARC_PATH}:${M8_PATH}:$PATH<br>
export PATH=${PATH}:/opt/staruml<br>
export USE_CCACHE=1
</p>

<p>
2.安装lzop<br>
sudo apt-get install lzop
</p>


<!-- End wiki content -->

</body>

</html>
